@page "/available-courses"
@layout MainLayout
@attribute [Authorize]

@inject CourseApiService CourseService
@inject NavigationManager Nav

<PageHeading Text="Available Courses" />

@if (_loading)
{
    <p>Loading courses...</p>
}
else if (_courses.Count == 0)
{
    <p>No courses available.</p>
}
else
{
    <div class="row g-3 mt-2">
        @foreach (var c in _courses)
        {
            <div class="col-12 col-sm-6 col-lg-4">
                <div class="ac-card shadow-sm">

                    <img src="@c.Thumbnail" class="ac-thumb" />

                    <div class="ac-body">
                        <h6 class="fw-bold text-dark">@c.Title</h6>
                        <p class="text-purple small">@c.Category</p>

                        <button class="btn-purple w-100"
                                @onclick="() => ViewCourse(c.Id)">
                            View Course
                        </button>
                    </div>

                </div>
            </div>
        }
    </div>
}

@code {
    private bool _loading = true;
    private List<CourseDto> _courses = new();

    protected override async Task OnInitializedAsync()
    {
        _loading = true;
        _courses = await CourseService.GetAllAsync() ?? new();
        _loading = false;
    }

    void ViewCourse(int id)
    {
        Nav.NavigateTo($"/course/{id}");
    }
}
